# VoiceForce 手動テスト手順書

**対象バージョン**: v0.1.0
**テスト環境**: Chrome + Salesforce Developer Edition
**前提条件**: 拡張機能が `dist/` からロード済み・Salesforce に接続済み

---

## 事前準備

```
1. chrome://extensions/ → VoiceForce が有効になっているか確認
2. ツールバーのアイコンをクリック → 「接続済み」になっているか確認
   （未接続の場合はコンシューマーキー・シークレットを入力して接続）
3. Salesforce Developer Edition を Chrome で開く
   URL: https://leala9-dev-ed.my.salesforce.com
```

---

## テスト 1: ポップアップ UI

### 1-1 未接続状態の表示

| 手順 | 期待結果 |
|------|---------|
| 拡張機能を一度切断する（「接続を解除」） | - |
| ツールバーのアイコンをクリック | ポップアップが開く |
| ステータスバッジを確認 | 「未接続」（赤） |
| コンシューマーキー入力欄を確認 | 表示されている |
| Salesforce URL 欄を確認 | `https://login.salesforce.com` が初期値 |
| 切断ボタンを確認 | 非表示 |

### 1-2 接続済み状態の表示

| 手順 | 期待結果 |
|------|---------|
| コンシューマーキーとシークレットを入力して「Salesforceに接続」 | 認証画面が開く |
| Salesforce で許可をクリック | ポップアップに戻る |
| ステータスバッジを確認 | 「接続済み」（緑） |
| instance URL を確認 | Salesforce の URL が表示される |
| 接続フォームを確認 | 非表示になっている |
| 切断ボタンを確認 | 表示されている |

### 1-3 ショートカット表示

| 手順 | 期待結果 |
|------|---------|
| ポップアップ下部を確認 | ショートカットキーが表示される |
| 「ショートカットをカスタマイズ」をクリック | `chrome://extensions/shortcuts` が開く |

**結果**: ☐ 合格 ☐ 不合格
**備考**:

---

## テスト 2: ウィジェット表示

### 2-1 ウィジェットの起動・終了

| 手順 | 期待結果 |
|------|---------|
| Salesforce のページを開く | - |
| `Option+V` を押す | 右下にウィジェットが表示される |
| ウィジェットの状態を確認 | 「リスニング中...」と表示される |
| `Option+V` をもう一度押す | ウィジェットが非表示になる |

### 2-2 Salesforce 以外のページでの動作

| 手順 | 期待結果 |
|------|---------|
| `https://google.com` を開く | - |
| `Option+V` を押す | ウィジェットが**表示されない** |
| `chrome://extensions/` のエラーを確認 | エラーが表示されない |

**結果**: ☐ 合格 ☐ 不合格
**備考**:

---

## テスト 3: 音声認識・ナビゲーション

> **操作方法**: `Option+V` → 発話 → 自動認識

### 3-1 一覧ページへの遷移

| 発話 | 期待遷移先 | 結果 |
|------|-----------|------|
| 「商談一覧を開いて」 | 商談一覧（デフォルト） | ☐ |
| 「取引先一覧を開いて」 | 取引先一覧 | ☐ |
| 「リード一覧を開いて」 | リード一覧 | ☐ |
| 「取引先責任者一覧を開いて」 | 取引先責任者一覧 | ☐ |

### 3-2 リストビュー指定での遷移

| 発話 | 期待リストビュー | 結果 |
|------|----------------|------|
| 「すべての商談を開いて」 | すべての商談 | ☐ |
| 「全ての商談を開いて」 | すべての商談 | ☐ |
| 「最近参照した商談を開いて」 | 最近参照した商談 | ☐ |
| 「自分の商談を開いて」 | 私の商談 | ☐ |

### 3-3 認識されない発話

| 発話 | 期待動作 | 結果 |
|------|---------|------|
| 「てすと」（無意味な発話） | 「認識: てすと」と表示・ウィジェット消える | ☐ |
| 沈黙（3秒待つ） | ウィジェットが自動で非表示になる | ☐ |

**結果**: ☐ 合格 ☐ 不合格
**備考**:

---

## テスト 4: 戻る操作

| 手順 | 発話 | 期待動作 | 結果 |
|------|------|---------|------|
| 商談一覧 → 商談詳細を開く | - | - | - |
| `Option+V` を押す | 「戻って」 | 商談一覧に戻る | ☐ |
| `Option+V` を押す | 「前に戻って」 | 1つ前のページに戻る | ☐ |

**結果**: ☐ 合格 ☐ 不合格
**備考**:

---

## テスト 5: エラーハンドリング

### 5-1 マイク許可

| 手順 | 期待動作 |
|------|---------|
| 初回 `Option+V` を押す | マイク許可ダイアログが表示される（初回のみ） |
| 「ブロック」を選択した場合 | エラーウィジェットが表示される |

### 5-2 接続切れ

| 手順 | 期待動作 |
|------|---------|
| ポップアップで「接続を解除」 | - |
| `Option+V` → 「商談一覧を開いて」 | 処理中になるがトークンエラーで失敗 or fallback 遷移 |

**結果**: ☐ 合格 ☐ 不合格
**備考**:

---

## テスト 6: セキュリティ確認

| 確認項目 | 確認方法 | 期待結果 | 結果 |
|---------|---------|---------|------|
| XSS インジェクション | 発話に `<script>alert(1)</script>` を含む文字列 | スクリプトが実行されない | ☐ |
| トークンが平文保存されていない | DevTools → Application → Local Storage を確認 | 暗号化された文字列のみ | ☐ |

**結果**: ☐ 合格 ☐ 不合格
**備考**:

---

## テスト結果サマリー

| テスト | 結果 |
|--------|------|
| 1. ポップアップ UI | ☐ 合格 ☐ 不合格 |
| 2. ウィジェット表示 | ☐ 合格 ☐ 不合格 |
| 3. 音声認識・ナビゲーション | ☐ 合格 ☐ 不合格 |
| 4. 戻る操作 | ☐ 合格 ☐ 不合格 |
| 5. エラーハンドリング | ☐ 合格 ☐ 不合格 |
| 6. セキュリティ確認 | ☐ 合格 ☐ 不合格 |

**テスト実施日**:
**テスト実施者**:
**総合結果**: ☐ 合格 ☐ 不合格（要修正）
